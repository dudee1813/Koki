<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Koki üíñ</title>

<style>
  body{
    margin:0;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:linear-gradient(135deg,#ffd1dc,#ffe6f0);
    font-family:system-ui;
    overflow:hidden;
    transition: background 900ms ease;
  }

  body.golden{
    background: radial-gradient(circle at top, #fff1b8, #ffcf6b, #ff7aa5);
  }

  #tap{
    padding:28px 42px;
    font-size:24px;
    background:white;
    border-radius:32px;
    box-shadow:0 18px 45px rgba(0,0,0,.25);
    cursor:pointer;
    user-select:none;
  }

  #scene{
    display:none;
    position:fixed;
    inset:0;
    background:linear-gradient(135deg,#ff9a9e,#fad0c4);
    color:#fff;
    overflow-y:auto;
    -webkit-overflow-scrolling:touch;
    padding:10vh 6vw 14vh;
    text-align:center;
    transition: background 900ms ease;
  }

  #scene.golden{
    background: radial-gradient(circle at top,
      rgba(255,241,184,.65),
      rgba(255,207,107,.35),
      rgba(255,122,165,.15));
  }

  .wrap{ max-width:780px; margin:0 auto; }

  .crownRow{
    font-size:44px;
    margin-bottom:10px;
    animation:pulse 1.6s ease-in-out infinite;
    transition: filter 600ms ease, transform 600ms ease;
    will-change: filter, transform;
  }

  .crownRow.glow{
    filter:
      drop-shadow(0 0 10px rgba(255,255,255,.9))
      drop-shadow(0 0 22px rgba(255,220,120,.95))
      drop-shadow(0 0 42px rgba(255,160,200,.85));
    transform: scale(1.18);
  }

  @keyframes pulse{
    0%,100%{transform:scale(1); opacity:1}
    50%{transform:scale(1.05); opacity:.95}
  }

  h1{
    font-size:44px;
    margin:0 0 8px;
    letter-spacing:1px;
    text-shadow:0 6px 24px rgba(0,0,0,.18);
  }
  h2{
    font-size:22px;
    font-weight:400;
    margin:0 0 18px;
    opacity:.95;
  }

  #countdown{
    font-size:28px;
    margin:10px 0 18px;
    font-weight:700;
    opacity:.95;
  }

  #msg{
    font-size:20px;
    line-height:1.7;
    margin:0 auto;
    white-space:pre-line;
  }

  .signature{
    margin-top:22px;
    font-size:18px;
    opacity:.95;
  }

  .actions{
    margin-top:18px;
    display:flex;
    gap:12px;
    justify-content:center;
    flex-wrap:wrap;
  }

  .btn{
    border:0;
    padding:12px 16px;
    border-radius:999px;
    background:rgba(255,255,255,.22);
    color:#fff;
    font-size:16px;
    cursor:pointer;
    backdrop-filter: blur(8px);
    border:1px solid rgba(255,255,255,.28);
  }
  .btn:active{transform:scale(.98)}
  .btnSolid{
    background:#fff;
    color:#ff5a7a;
    border:0;
  }

  .heart{
    position:absolute;
    animation:float 4s linear forwards;
    user-select:none;
    pointer-events:none;
  }
  @keyframes float{
    from{transform:translateY(0);opacity:1}
    to{transform:translateY(-120vh);opacity:0}
  }

  .sparkle{
    position:absolute;
    color:rgba(255,255,255,.9);
    animation:spark 1.8s ease-in-out infinite;
    user-select:none;
    pointer-events:none;
  }
  @keyframes spark{
    0%,100%{opacity:.2; transform:scale(.9) rotate(0deg)}
    50%{opacity:.9; transform:scale(1.15) rotate(12deg)}
  }

  #wishNote{ display:none; margin-top:14px; font-size:18px; opacity:.98; text-shadow:0 6px 22px rgba(0,0,0,.18); }
  #wishSecret{ display:none; margin-top:10px; font-size:16px; opacity:.92; }

  .confetti{
    position:absolute;
    top:-20px;
    width:10px;
    height:14px;
    border-radius:3px;
    opacity:.95;
    animation:fall linear forwards;
    pointer-events:none;
  }
  @keyframes fall{
    to{ transform: translateY(calc(100vh + 60px)) rotate(720deg); }
  }
</style>
</head>

<body>
<div id="tap">‚ú® Tap here ‚ú®</div>

<div id="scene">
  <div class="wrap">
    <div class="crownRow" id="crown">üíñ</div>
    <h1>Koki</h1>
    <h2>Always Special</h2>

    <div id="countdown">Ready? üíó</div>
    <div id="msg"></div>

    <div class="signature" id="sig" style="display:none;">
      ‚Äî From <b>Duraid</b> üíñ
    </div>

    <div id="wishNote">üíå Another little secret for you‚Ä¶</div>
    <div id="wishSecret"><b>Koki always deserves the sweetest wishes ‚ú®</b></div>

    <div class="actions" id="actions" style="display:none;">
      <button class="btn btnSolid" id="wishBtn">Make a wish ‚ú®</button>
      <button class="btn" id="musicToggle">Music üé∂</button>
    </div>
  </div>
</div>

<!-- Put music.mp3 beside index.html -->
<audio id="music" loop preload="auto" playsinline>
  <source src="./music.mp3?v=1" type="audio/mpeg">
</audio>

<script>
const tap = document.getElementById("tap");
const scene = document.getElementById("scene");
const crown = document.getElementById("crown");
const countdown = document.getElementById("countdown");
const msg = document.getElementById("msg");
const sig = document.getElementById("sig");
const actions = document.getElementById("actions");
const wishBtn = document.getElementById("wishBtn");
const music = document.getElementById("music");
const musicToggle = document.getElementById("musicToggle");
const wishNote = document.getElementById("wishNote");
const wishSecret = document.getElementById("wishSecret");

const fullText =
`Koki üíñ

Just a small message to remind you:
You matter.
You‚Äôre appreciated.
And your presence makes life lighter.

Your smile is a blessing,
your heart is beautiful,
and you deserve the best things ‚Äî always ‚ú®

Stay amazing üå∏
`;

function popHearts(){
  setInterval(()=>{
    const h = document.createElement("div");
    h.className = "heart";
    const emojis = ["üíñ","üíï","üíó","‚ú®","üíû","üå∏"];
    h.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    h.style.left = Math.random()*100 + "vw";
    h.style.bottom = "-30px";
    h.style.fontSize = (18 + Math.random()*26) + "px";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),4000);
  },240);
}

function sparkles(){
  for(let i=0;i<14;i++){
    const sp = document.createElement("div");
    sp.className = "sparkle";
    sp.textContent = "‚ú¶";
    sp.style.left = Math.random()*100 + "vw";
    sp.style.top  = Math.random()*70 + "vh";
    sp.style.fontSize = (10 + Math.random()*14) + "px";
    sp.style.animationDelay = (Math.random()*1.2) + "s";
    document.body.appendChild(sp);
  }
}

function typeWriter(text){
  msg.textContent = "";
  let i = 0;
  const t = setInterval(()=>{
    msg.textContent += text[i] || "";
    i++;
    if(i >= text.length){
      clearInterval(t);
      sig.style.display = "block";
      actions.style.display = "flex";
    }
  }, 50);
}

function doCountdown(){
  const nums = ["3‚Ä¶","2‚Ä¶","1‚Ä¶","üíñ"];
  let i=0;
  const c = setInterval(()=>{
    countdown.textContent = nums[i];
    i++;
    if(i === nums.length){
      clearInterval(c);
      countdown.textContent = "For you üíó";
      typeWriter(fullText);
    }
  }, 240);
}

async function startMusic(){
  try{ await music.play(); return true; }
  catch(e){ return false; }
}

function fadeInMusic(target=0.35, step=0.02, ms=320){
  try{
    music.volume = 0.05;
    const id = setInterval(()=>{
      music.volume = Math.min(target, music.volume + step);
      if(music.volume >= target) clearInterval(id);
    }, ms);
  }catch(e){}
}

function confettiBurst(n=80){
  for(let i=0;i<n;i++){
    const d = document.createElement("div");
    d.className = "confetti";
    d.style.left = Math.random()*100 + "vw";
    d.style.background = `hsl(${Math.random()*360}, 90%, 60%)`;
    d.style.animationDuration = (1.6 + Math.random()*1.8) + "s";
    document.body.appendChild(d);
    setTimeout(() => d.remove(), 4000);
  }
}

function heartExplosion(){
  for(let i=0;i<40;i++){
    const h = document.createElement("div");
    h.className = "heart";
    const emojis = ["üíñ","üíï","üíó","üíû","‚ú®","üå∏"];
    h.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    h.style.left = (Math.random()*100) + "vw";
    h.style.bottom = "0px";
    h.style.fontSize = (22 + Math.random()*32) + "px";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),4000);
  }
}

tap.addEventListener("click", async () => {
  tap.style.display = "none";
  scene.style.display = "block";

  sparkles();
  popHearts();
  doCountdown();

  const ok = await startMusic();
  if(ok) fadeInMusic();
});

let wishedOnce = false;
wishBtn.onclick = () => {
  if(wishedOnce) return;
  wishedOnce = true;

  crown.classList.add("glow");
  setTimeout(()=>crown.classList.remove("glow"), 2200);

  confettiBurst(90);
  heartExplosion();

  wishNote.style.display = "block";
  wishSecret.style.display = "block";

  document.body.classList.add("golden");
  scene.classList.add("golden");
  countdown.textContent = "Wish granted ‚ú®";

  try{ music.volume = Math.min(1, (music.volume || 0.35) + 0.20); }catch(e){}
};

musicToggle.onclick = async () => {
  if(!music.paused){
    music.pause();
    musicToggle.textContent = "Music üé∂";
  }else{
    const ok = await startMusic();
    if(ok){ fadeInMusic(); musicToggle.textContent = "Stop ‚è∏"; }
  }
};
</script>

</body>
</html>
